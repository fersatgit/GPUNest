#version 460
#define c 3.1415926535897932384626433832795
#define d vec2(.5,.25)
layout(binding=0)buffer SSBO0{ivec4 DistanceMap[128];};layout(points)in;layout(triangle_strip,max_vertices=4)out;out vec2 TexCoord;layout(location=0)uniform vec4 Param;void main(){int e=int(gl_in[0].gl_Position.z);float f=e*c/32;int g=DistanceMap[e+0].y;int h=DistanceMap[e+16].y;int j=DistanceMap[e+32].y;int k=DistanceMap[e+48].y;vec4 l=fma(gl_in[0].gl_Position.xyxy+vec4(-k,-j,h,g),2/Param.zwzw,vec4(-1,-1,-1,-1));float m=atan(k,g)-f;gl_Position=vec4(l.xw,0,1);TexCoord=fma(vec2(-sin(m),cos(m))*length(vec2(k,g)),Param.xy,d);EmitVertex();m=-atan(h,g)-f;gl_Position=vec4(l.zw,0,1);TexCoord=fma(vec2(-sin(m),cos(m))*length(vec2(h,g)),Param.xy,d);EmitVertex();m=c-atan(k,j)-f;gl_Position=vec4(l.xy,0,1);TexCoord=fma(vec2(-sin(m),cos(m))*length(vec2(k,j)),Param.xy,d);EmitVertex();m=c+atan(h,j)-f;gl_Position=vec4(l.zy,0,1);TexCoord=fma(vec2(-sin(m),cos(m))*length(vec2(h,j)),Param.xy,d);EmitVertex();EndPrimitive();}